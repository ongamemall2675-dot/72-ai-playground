# ğŸ”— n8n í†µí•© ê°€ì´ë“œ

## Script Generator APIë¥¼ n8nê³¼ ì—°ê²°í•˜ê¸°

### ğŸ“¡ ì›¹í›… ì—”ë“œí¬ì¸íŠ¸

Script GeneratorëŠ” n8n í†µí•©ì„ ìœ„í•œ ì „ìš© ì›¹í›… ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤:

```
POST http://152.42.210.15:8003/webhook/script
Content-Type: application/json
```

ë˜ëŠ” ë„ë©”ì¸ ì„¤ì • ì‹œ:
```
POST https://script.hyehwa72.org/webhook/script
Content-Type: application/json
```

---

## ğŸ¯ n8n ì›Œí¬í”Œë¡œìš° ì„¤ì •

### 1ï¸âƒ£ HTTP Request ë…¸ë“œ ì„¤ì •

**ê¸°ë³¸ ì„¤ì •:**
- **Method**: POST
- **URL**: `http://152.42.210.15:8003/webhook/script`
- **Authentication**: None (ë˜ëŠ” API Key ì„¤ì • ì‹œ ì‚¬ìš©)
- **Body Content Type**: JSON

**ìš”ì²­ ë°”ë”” (Body):**
```json
{
  "topic": "ë¶€ë™ì‚° íˆ¬ì ì´ˆë³´ìë¥¼ ìœ„í•œ ê°€ì´ë“œ",
  "ai_provider": "gemini",
  "category": "real_estate",
  "duration": "5min",
  "structure": "hook_develop_resolve",
  "tone": "professional",
  "auto_split_scenes": true
}
```

---

## ğŸ“‹ ìš”ì²­ íŒŒë¼ë¯¸í„°

### í•„ìˆ˜ íŒŒë¼ë¯¸í„°
- **topic** (string): ëŒ€ë³¸ ì£¼ì œ

### ì„ íƒ íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… | ì˜µì…˜ |
|---------|------|--------|------|------|
| `ai_provider` | string | "gemini" | AI ëª¨ë¸ | gemini, claude, openai |
| `category` | string | "education" | ì¹´í…Œê³ ë¦¬ | education, entertainment, real_estate, finance, health, tech, vlog, other |
| `duration` | string | "5min" | ì¬ìƒ ì‹œê°„ | 30sec, 1min, 5min, 10min |
| `structure` | string | "hook_develop_resolve" | êµ¬ì¡° | hook_develop_resolve, four_act, problem_solution, listicle |
| `tone` | string | "friendly" | í†¤ | friendly, professional, humorous, dramatic, calm |
| `audience_age` | string | "all" | ëŒ€ìƒ ì—°ë ¹ | all, teen, 20s, 30s, 40s, 50s |
| `audience_gender` | string | "all" | ëŒ€ìƒ ì„±ë³„ | all, male, female |
| `audience_persona` | string | "general" | ëŒ€ìƒ í˜ë¥´ì†Œë‚˜ | general, investor, first_buyer, curious |
| `hook_style` | string | "question" | í›„í‚¹ ìŠ¤íƒ€ì¼ | question, shock, empathy, number |
| `cta_type` | string | "subscribe" | CTA íƒ€ì… | subscribe, comment, none |
| `required_keywords` | array | [] | í•„ìˆ˜ í‚¤ì›Œë“œ | ["í‚¤ì›Œë“œ1", "í‚¤ì›Œë“œ2"] |
| `forbidden_words` | array | [] | ê¸ˆì§€ì–´ | ["ê¸ˆì§€ì–´1", "ê¸ˆì§€ì–´2"] |
| `writer_id` | string | null | ì‘ê°€ í˜ë¥´ì†Œë‚˜ ID | writer_20240102123456 |
| `custom_instructions` | string | "" | ì»¤ìŠ¤í…€ ì§€ì¹¨ | ììœ  í…ìŠ¤íŠ¸ |
| `auto_split_scenes` | boolean | false | ìë™ ì¥ë©´ ë¶„í•  | true, false |

---

## ğŸ“¤ ì‘ë‹µ í˜•ì‹

### ì„±ê³µ ì‘ë‹µ
```json
{
  "success": true,
  "script": "ìƒì„±ëœ ëŒ€ë³¸ í…ìŠ¤íŠ¸...",
  "scenes": [
    {
      "scene_id": 1,
      "script_text": "ì¥ë©´ 1 ëŒ€ë³¸",
      "keywords": ["í‚¤ì›Œë“œ1"],
      "emotion": "neutral"
    }
  ],
  "metadata": {
    "ai_provider": "gemini",
    "topic": "ë¶€ë™ì‚° íˆ¬ì ì´ˆë³´ìë¥¼ ìœ„í•œ ê°€ì´ë“œ",
    "duration": "5min",
    "generated_at": "2026-01-02T23:30:00.000000"
  }
}
```

### ì‹¤íŒ¨ ì‘ë‹µ
```json
{
  "success": false,
  "error": "ì—ëŸ¬ ë©”ì‹œì§€"
}
```

---

## ğŸ”§ n8n ì›Œí¬í”Œë¡œìš° ì˜ˆì œ

### ì˜ˆì œ 1: ê°„ë‹¨í•œ ëŒ€ë³¸ ìƒì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Webhook    â”‚â”€â”€â”€â”€â”€â–¶â”‚ HTTP Request â”‚â”€â”€â”€â”€â”€â–¶â”‚  Respond    â”‚
â”‚  (íŠ¸ë¦¬ê±°)    â”‚      â”‚ (Script Gen) â”‚      â”‚  (ì‘ë‹µ)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Webhook ë…¸ë“œ**: ì™¸ë¶€ì—ì„œ íŠ¸ë¦¬ê±°
**HTTP Request ë…¸ë“œ**:
```json
{
  "topic": "{{$json.topic}}",
  "ai_provider": "gemini",
  "auto_split_scenes": true
}
```

---

### ì˜ˆì œ 2: Google Sheets â†’ ëŒ€ë³¸ ìƒì„± â†’ ì €ì¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Google Sheetsâ”‚â”€â”€â–¶â”‚ HTTP Request â”‚â”€â”€â–¶â”‚     Set      â”‚â”€â”€â–¶â”‚Google Sheetsâ”‚
â”‚   (ì½ê¸°)     â”‚   â”‚ (Script Gen) â”‚   â”‚  (ë°ì´í„°ì •ë¦¬) â”‚   â”‚   (ì“°ê¸°)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Google Sheets (ì½ê¸°)**: Aì—´ì— ì£¼ì œ ëª©ë¡
**HTTP Request**: ê° ì£¼ì œë§ˆë‹¤ ëŒ€ë³¸ ìƒì„±
**Set**: í•„ìš”í•œ í•„ë“œë§Œ ì¶”ì¶œ
**Google Sheets (ì“°ê¸°)**: Bì—´ì— ìƒì„±ëœ ëŒ€ë³¸ ì €ì¥

---

### ì˜ˆì œ 3: Notion â†’ ëŒ€ë³¸ ìƒì„± â†’ TTS â†’ ì €ì¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Notion    â”‚â”€â”€â–¶â”‚ HTTP Request â”‚â”€â”€â–¶â”‚ HTTP Request â”‚â”€â”€â–¶â”‚   Notion    â”‚
â”‚   (ì½ê¸°)     â”‚   â”‚ (Script Gen) â”‚   â”‚    (TTS)     â”‚   â”‚   (ì—…ë°ì´íŠ¸) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Notion (ì½ê¸°)**: ì£¼ì œ ë°ì´í„°ë² ì´ìŠ¤
**HTTP Request (Script)**: ëŒ€ë³¸ ìƒì„±
**HTTP Request (TTS)**: TTS ìŒì„± ìƒì„± (ë‹¤ë¥¸ ì„œë¹„ìŠ¤)
**Notion (ì—…ë°ì´íŠ¸)**: ëŒ€ë³¸ ë° ìŒì„± íŒŒì¼ ì €ì¥

---

### ì˜ˆì œ 4: ìŠ¤ì¼€ì¤„ ìë™ ëŒ€ë³¸ ìƒì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Schedule   â”‚â”€â”€â–¶â”‚     Code     â”‚â”€â”€â–¶â”‚ HTTP Request â”‚â”€â”€â–¶â”‚   Send to   â”‚
â”‚  (ë§¤ì¼ 9am)  â”‚   â”‚ (ì£¼ì œ ì„ íƒ)   â”‚   â”‚ (Script Gen) â”‚   â”‚   Slack     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Schedule**: ë§¤ì¼ ì˜¤ì „ 9ì‹œ ì‹¤í–‰
**Code**: JavaScriptë¡œ ëœë¤ ì£¼ì œ ì„ íƒ
**HTTP Request**: ëŒ€ë³¸ ìƒì„±
**Slack**: íŒ€ì— ê²°ê³¼ ê³µìœ 

---

## ğŸ’¡ í™œìš© ì‚¬ë¡€

### 1. ì½˜í…ì¸  ì œì‘ ìë™í™”
- **íŠ¸ë¦¬ê±°**: Google Forms ì œì¶œ
- **ì²˜ë¦¬**: ì£¼ì œ ê¸°ë°˜ ëŒ€ë³¸ ìë™ ìƒì„±
- **ì €ì¥**: Notion, Airtable, Google Sheets

### 2. ì†Œì…œ ë¯¸ë””ì–´ ì½˜í…ì¸ 
- **íŠ¸ë¦¬ê±°**: ìŠ¤ì¼€ì¤„ (ë§¤ì¼/ë§¤ì£¼)
- **ì²˜ë¦¬**: íŠ¸ë Œë“œ í‚¤ì›Œë“œë¡œ ëŒ€ë³¸ ìƒì„±
- **ë°°í¬**: Instagram, YouTube ìŠ¤í¬ë¦½íŠ¸ ì¤€ë¹„

### 3. ê³ ê° ë§ì¶¤í˜• ì½˜í…ì¸ 
- **íŠ¸ë¦¬ê±°**: CRM ë°ì´í„° ì—…ë°ì´íŠ¸
- **ì²˜ë¦¬**: ê³ ê° í˜ë¥´ì†Œë‚˜ë³„ ë§ì¶¤ ëŒ€ë³¸
- **ì „ë‹¬**: ì´ë©”ì¼, ë©”ì‹œì§€ ìë™ ë°œì†¡

### 4. êµìœ¡ ì½˜í…ì¸  ì œì‘
- **íŠ¸ë¦¬ê±°**: ê°•ì˜ ì£¼ì œ ë¦¬ìŠ¤íŠ¸
- **ì²˜ë¦¬**: êµìœ¡ìš© ëŒ€ë³¸ ì¼ê´„ ìƒì„±
- **í†µí•©**: LMS ì‹œìŠ¤í…œ ìë™ ì—…ë¡œë“œ

---

## ğŸ” ì¸ì¦ ì„¤ì • (ì„ íƒì‚¬í•­)

í˜„ì¬ëŠ” ì¸ì¦ ì—†ì´ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë³´ì•ˆì´ í•„ìš”í•œ ê²½ìš°:

### API Key í—¤ë” ì¶”ê°€ (í–¥í›„ ì§€ì› ì˜ˆì •)
```
Authorization: Bearer YOUR_API_KEY
X-API-Key: YOUR_API_KEY
```

### IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ (Nginx ë ˆë²¨)
ì„œë²„ ì¸¡ì—ì„œ íŠ¹ì • IPë§Œ í—ˆìš© ê°€ëŠ¥

---

## ğŸ” ë””ë²„ê¹… ë° ëª¨ë‹ˆí„°ë§

### Health Check
```
GET http://152.42.210.15:8003/health
```

ì‘ë‹µ:
```json
{
  "status": "healthy",
  "module": "m06_script",
  "port": 8003,
  "version": "2.0.0"
}
```

### API ë¬¸ì„œ
```
http://152.42.210.15:8003/docs
```
FastAPIì˜ ìë™ ìƒì„± ë¬¸ì„œë¡œ ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ í™•ì¸ ê°€ëŠ¥

---

## ğŸ“Š n8n ë…¸ë“œ ì„¤ì • ìŠ¤í¬ë¦°ìƒ· ê°€ì´ë“œ

### HTTP Request ë…¸ë“œ ì„¤ì •

1. **Method**: POST ì„ íƒ
2. **URL**: `http://152.42.210.15:8003/webhook/script`
3. **Authentication**: None
4. **Send Body**: Yes
5. **Body Content Type**: JSON
6. **Specify Body**: Using JSON
7. **JSON**: ì•„ë˜ JSON ì…ë ¥

```json
{
  "topic": "{{$json.topic}}",
  "ai_provider": "gemini",
  "category": "real_estate",
  "duration": "5min",
  "auto_split_scenes": true
}
```

8. **Options**:
   - Timeout: 120000 (2ë¶„)
   - Follow Redirect: Yes

---

## âš¡ ì„±ëŠ¥ ë° ì œí•œì‚¬í•­

- **ì‘ë‹µ ì‹œê°„**: í‰ê·  10-30ì´ˆ (AI ëª¨ë¸ì— ë”°ë¼ ë‹¤ë¦„)
- **íƒ€ì„ì•„ì›ƒ**: 120ì´ˆ
- **ë™ì‹œ ìš”ì²­**: ì œí•œ ì—†ìŒ (ì„œë²„ ë¦¬ì†ŒìŠ¤ì— ë”°ë¼)
- **ìš”ì²­ í¬ê¸°**: ìµœëŒ€ 10MB

---

## ğŸ†˜ ë¬¸ì œ í•´ê²°

### íƒ€ì„ì•„ì›ƒ ë°œìƒ
- n8n HTTP Request ë…¸ë“œì˜ Timeout ì„¤ì •ì„ 120000msë¡œ ì¦ê°€

### ì—°ê²° ì‹¤íŒ¨
```bash
# ì„œë²„ ìƒíƒœ í™•ì¸
ssh root@152.42.210.15 "systemctl status script-generator"

# í¬íŠ¸ í™•ì¸
ssh root@152.42.210.15 "netstat -tupln | grep 8003"
```

### API í‚¤ ì—ëŸ¬
ì„œë²„ì˜ í™˜ê²½ ë³€ìˆ˜ì— AI API í‚¤ê°€ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸

---

## ğŸ“ ì§€ì›

ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ì„œë²„ ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”:

```bash
ssh root@152.42.210.15 "journalctl -u script-generator -f"
```

---

**n8n í†µí•© ì™„ë£Œ!** âœ¨

ì´ ê°€ì´ë“œëŒ€ë¡œ ì„¤ì •í•˜ë©´ n8nì—ì„œ Script Generator APIë¥¼ ì™„ë²½í•˜ê²Œ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
