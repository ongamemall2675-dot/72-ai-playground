#!/bin/bash
# 간단한 서버 수동 배포 가이드

echo "==================================="
echo "Script Generator 수동 배포 가이드"
echo "==================================="
echo ""
echo "1. 서버에 SSH 접속:"
echo "   ssh root@152.42.210.15"
echo ""
echo "2. 프로젝트 디렉토리로 이동/생성:"
echo "   cd /root"
echo "   mkdir -p script-generator"
echo "   cd script-generator"
echo ""
echo "3. GitHub에서 최신 코드 가져오기:"
echo "   git clone https://github.com/ongamemall2675-dot/72-ai-playground.git temp"
echo "   cp -r temp/script-generator/* ."
echo "   rm -rf temp"
echo ""
echo "   또는 기존 저장소가 있다면:"
echo "   git pull origin main"
echo ""
echo "4. Python 가상환경 생성 및 활성화:"
echo "   python3 -m venv venv"
echo "   source venv/bin/activate"
echo ""
echo "5. 의존성 설치:"
echo "   pip install -r requirements.txt"
echo ""
echo "6. 환경 변수 설정:"
echo "   cp .env.example .env"
echo "   nano .env  # API 키 입력"
echo ""
echo "7. Systemd 서비스 설정:"
echo "   sudo cp script-generator.service /etc/systemd/system/"
echo "   sudo nano /etc/systemd/system/script-generator.service"
echo "   # ExecStart 경로를 가상환경 경로로 수정:"
echo "   # ExecStart=/root/script-generator/venv/bin/uvicorn main:app --host 0.0.0.0 --port 8003"
echo ""
echo "8. 서비스 시작:"
echo "   sudo systemctl daemon-reload"
echo "   sudo systemctl enable script-generator"
echo "   sudo systemctl start script-generator"
echo "   sudo systemctl status script-generator"
echo ""
echo "9. Nginx 설정 (선택사항):"
echo "   sudo cp nginx-script-generator.conf /etc/nginx/sites-available/"
echo "   sudo ln -sf /etc/nginx/sites-available/nginx-script-generator.conf /etc/nginx/sites-enabled/"
echo "   sudo nginx -t"
echo "   sudo systemctl reload nginx"
echo ""
echo "10. 로그 확인:"
echo "    sudo journalctl -u script-generator -f"
echo ""
echo "==================================="
